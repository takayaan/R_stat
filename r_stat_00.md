# Rと統計の勉強会 第0回

### まずはRについて

#### 1. そもそもRとは何なのか

主に統計解析に利用されることを前提に開発されたプログラミング言語、開発実行環境  
フリーソフトなので当然無料で、完全無保証
自由に利用、改変、再配布ができる→様々な人が無償で開発している

#### 2. なぜRが良いのか

いろんな人がいろんな事を言っていますが、集約すると以下の項目が挙げられる

- 信頼性と再現性  

Rで用いられているプログラムコードは全てオープンソースであり、公開されている。つまり、様々な人の目に触れることでそのコードはより洗練されたものになっている。そしてこれらのコードを用いた解析は当然のことながら再現性が高いと言える。

- GUI(Graphical User Interface)の弱点

SPSSはGUIの代表的な統計解析ソフトである。マウス操作によるGUIは直感的に解析を進めることができるが、逆に自由度は低くなる。少しのデータの変化でもGUIでは最初からやり直さざるを得なくなることが少なからずある。  
プログラミング言語は習得にやや時間はかかるが、一度基本を身につけてしまうと応用が効く。また、世界中にRユーザーがいるためわからないことがあれば、検索すれば大体の事は解決できるだろうし、できなければコミュニティーに質問すれば誰かが教えてくれる。

- 自動化

一度コードを書いてしまうと、異なるデータを用いで同様の解析を行う事は容易である。解析の自動化は解析の再現性にも繋がる。

- アップデート

Rは多くの科学研究者に利用されているため、最新の統計解析手法についてもパッケージという形で公開され、しかもそれを自由に使うことが可能である。SPSSなどのコンシューマーベースの解析ソフトではアップデートに時間も費用もかかってしまう上、自分で付け足すことができない。

### Rをインストールしよう

1. [CRAN(The Comprehensive R Archive Network)](https://cran.r-project.org/)のホームページからインストーラーをダウンロードする

2. インストーラーを開いてインストールする


### R studioをインストールしよう

1. [R studio](https://www.rstudio.com/products/rstudio/download/)のホームページからインストーラーをダウンロードする
2. インストーラーを開いてダウンロードする  

**基本的にはR studio前提で勉強会を進めますので、R studioでの作業をお勧めします**

### 作業ディレクトリ

ディレクトリ＝階層（ひとまずフォルダと考えて、大きな問題はない）

例）
Windowsの場合：
C:¥Users¥Owner¥Documents
Macの場合：
/Users/ユーザー名/Documents

今どこでRを作業しているかがすごく大事
`getwd()`で現在作業しているディレクトリを知る事ができる
`setwd(パス)`でパスの場所に作業ディレクトリを設定できる

### パッケージ

Rには様々なパッケージがあり、同様の解析手法についても多数のパッケージが存在する事が多い。基本的にどのパッケージを使っても問題はない事が多いのだが、信頼性の高いパッケージを選ぶ事が必要である。

- パッケージインストール
現在、Rのパッケージは CRAN、Bioconductor、Githubからインストール可能
    - CRAN
      ```R
      install.packages("パッケージ名")
      ```
    - Bioconductor
      ```R
      source("http://bioconductor.org/biocLite.R")
      biocLite("パッケージ名")
      ```
    - Github: `devtool`パッケージをインストールしておく必要がある
      ```R
      install.packages("devtools")
      library(devtools)
      install_github("ユーザー名/レポジトリ名")
      ```
- パッケージの適用
インストールしたパッケージを使用する際には、Rの起動毎にパッケージを適用する必要がある
```R
library(パッケージ名)
```

### プロキシ設定

RではパッケージやデータをRから直接webに接続してダウンロードする事が可能だが、プロキシ接続している場合は環境設定にプロキシの情報を与えないといけない
```R
Sys.setenv("http_proxy"="http://プロキシサーバ:ポート番号")
Sys.setenv("https_proxy"="https://プロキシサーバ:ポート番号")
```
さらに、CRANからインストールする場合には以下を設定しておくとbetter
```R
options(repos=local({
  r <- getOption("repos")
  r["CRAN"] <- "http://cran.ism.ac.jp"
  r
}))
```
Bioconductorからインストールする場合には以下を設定
```R
options(RCurlOptions = list(proxy = "http://プロキシサーバ:ポート番号"))
```

Githubからインストールする場合には以下を設定: `httr`パッケージをインストールする必要あり
```R
library(httr)
set_config(use_proxy(url="http://プロキシサーバ", port=ポート番号))
```

ややこしいですが、これがないと始まらないのでプロキシ環境でRを使う場合は最初にまとめて設定しておいた方がいい

#### プロキシ環境下でしか使わない場合

Rが参照する環境設定でプロキシ設定をしておくと毎回設定する必要がない。

```R
file.edit("~/.Renviron")
>>"http_proxy=http://プロキシサーバ:ポート番号"
>>"https_proxy=https://プロキシサーバ:ポート番号"
```



### 補足
- 勉強会の進行  

  レジメはmarkdown/Rmarkdownで作成しています。
  表示はできる限りスライドを作成します。

- 参加できなかった場合
全ての勉強会の資料はgithubにアップします。

### スケジュール（暫定）

1. Rの使い方
1. 統計の基礎
1. 確率の基礎
1. 推定
1. 統計学的仮説検定
1. 平均値の検定
1. クロス表検定
1. 回帰分析
1. 生存解析
1. 多変量解析
